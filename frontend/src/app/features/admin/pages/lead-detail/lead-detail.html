<div class="min-h-screen bg-gradient-to-br from-zinc-900 via-zinc-800 to-zinc-900">
  <div class="max-w-5xl mx-auto px-4 py-8">
    <button
      (click)="goBack()"
      class="mb-6 px-4 py-2 bg-zinc-700 hover:bg-zinc-600 text-white rounded-lg transition inline-flex items-center gap-2"
    >
      ← Zurück zum Dashboard
    </button>

    @if (isLoading) {
      <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-12 text-center text-zinc-400">
        Lade Lead-Details...
      </div>
    } @else if (lead) {
      <div class="space-y-6">
        <!-- Header -->
        <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
          <div class="flex items-start justify-between mb-4">
            <div>
              <h1 class="text-3xl font-bold text-white mb-2">{{ lead.name }}</h1>
              <span [class]="'px-3 py-1 text-xs font-medium rounded-full border ' + getStatusBadgeClass(lead.status)">
                {{ lead.status }}
              </span>
            </div>
            <div class="text-right">
              <div class="text-sm text-zinc-400">Lead ID</div>
              <div class="text-2xl font-bold text-white">#{{ lead.id }}</div>
            </div>
          </div>
        </div>

        <!-- Contact Info -->
        <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
          <h2 class="text-xl font-bold text-white mb-4">Kontaktinformationen</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <div class="text-sm text-zinc-400 mb-1">E-Mail</div>
              <div class="flex items-center gap-2">
                <div class="text-white">{{ lead.email }}</div>
                <button
                  (click)="openEmail()"
                  class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition"
                >
                  E-Mail senden
                </button>
              </div>
            </div>
            <div>
              <div class="text-sm text-zinc-400 mb-1">WhatsApp</div>
              <div class="flex items-center gap-2">
                <div class="text-white">{{ lead.whatsapp_country_code }} {{ lead.whatsapp_number }}</div>
                <button
                  (click)="openWhatsApp()"
                  class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs rounded transition"
                >
                  WhatsApp öffnen
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Tattoo Details -->
        <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
          <h2 class="text-xl font-bold text-white mb-4">Tattoo-Beschreibung</h2>
          <div class="bg-zinc-900/50 rounded-lg p-4 text-zinc-300 whitespace-pre-wrap">{{ lead.tattoo_description }}</div>

          @if (lead.reference_images && lead.reference_images.length > 0) {
            <div class="mt-4">
              <div class="text-sm text-zinc-400 mb-2">Referenzbilder ({{ lead.reference_images.length }})</div>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                @for (image of lead.reference_images; track image) {
                  <div class="aspect-square bg-zinc-900 rounded-lg overflow-hidden border border-zinc-700">
                    <img [src]="image" [alt]="'Referenzbild'" class="w-full h-full object-cover" />
                  </div>
                }
              </div>
            </div>
          }
        </div>

        <!-- Discount & Campaign Info -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
            <h2 class="text-xl font-bold text-white mb-4">Rabatt-Informationen</h2>
            <div class="text-center py-4">
              <div class="text-5xl font-bold text-red-400 mb-2">{{ lead.discount_percentage }}%</div>
              <div class="text-zinc-400">Rabatt gewährt</div>
            </div>
            <div class="mt-4 space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-zinc-400">E-Mail gesendet:</span>
                <span [class]="lead.email_sent ? 'text-green-400' : 'text-red-400'">
                  {{ lead.email_sent ? 'Ja' : 'Nein' }}
                </span>
              </div>
              <div class="flex justify-between">
                <span class="text-zinc-400">WhatsApp gesendet:</span>
                <span [class]="lead.whatsapp_sent ? 'text-green-400' : 'text-red-400'">
                  {{ lead.whatsapp_sent ? 'Ja' : 'Nein' }}
                </span>
              </div>
            </div>
          </div>

          <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
            <h2 class="text-xl font-bold text-white mb-4">Kampagnen-Daten</h2>
            <div class="space-y-3 text-sm">
              @if (lead.lead_source) {
                <div>
                  <div class="text-zinc-400">Lead-Quelle</div>
                  <div class="text-white">{{ lead.lead_source }}</div>
                </div>
              }
              @if (lead.utm_source) {
                <div>
                  <div class="text-zinc-400">UTM Source</div>
                  <div class="text-white">{{ lead.utm_source }}</div>
                </div>
              }
              @if (lead.utm_medium) {
                <div>
                  <div class="text-zinc-400">UTM Medium</div>
                  <div class="text-white">{{ lead.utm_medium }}</div>
                </div>
              }
              @if (lead.utm_campaign) {
                <div>
                  <div class="text-zinc-400">UTM Campaign</div>
                  <div class="text-white">{{ lead.utm_campaign }}</div>
                </div>
              }
              @if (lead.ip_address) {
                <div>
                  <div class="text-zinc-400">IP-Adresse</div>
                  <div class="text-white font-mono text-xs">{{ lead.ip_address }}</div>
                </div>
              }
            </div>
          </div>
        </div>

        <!-- Status Management -->
        <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
          <h2 class="text-xl font-bold text-white mb-4">Status verwalten</h2>
          <div class="flex items-center gap-4">
            <select
              [(ngModel)]="selectedStatus"
              class="flex-1 px-4 py-2 bg-zinc-900/50 border border-zinc-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-600"
            >
              @for (option of statusOptions; track option.value) {
                <option [value]="option.value">{{ option.label }}</option>
              }
            </select>
            <button
              (click)="updateStatus()"
              [disabled]="isSavingStatus || selectedStatus === lead.status"
              class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
            >
              @if (isSavingStatus) {
                <span>Speichern...</span>
              } @else {
                <span>Status aktualisieren</span>
              }
            </button>
          </div>
        </div>

        <!-- Timestamps -->
        <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-6">
          <h2 class="text-xl font-bold text-white mb-4">Zeitstempel</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
            <div>
              <div class="text-zinc-400">Erstellt am</div>
              <div class="text-white">{{ formatDate(lead.created_at) }}</div>
            </div>
            <div>
              <div class="text-zinc-400">Zuletzt aktualisiert</div>
              <div class="text-white">{{ formatDate(lead.updated_at) }}</div>
            </div>
          </div>
        </div>
      </div>
    } @else {
      <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-12 text-center text-zinc-400">
        Lead nicht gefunden
      </div>
    }
  </div>
</div>
